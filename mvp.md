# EASM Web UI — MVP Specification

## 0) Структура вебпроєкту (MVP-сторінки)

- **Organisation scan** — вибір організації → автоматичний підбір асетів → вибір пресету/модулів → команда запуску.
- **Preset creator** — створення/редагування/видалення пресетів (окрема сторінка).
- **Custom scan** — ручний конструктор: модулі + пресет(и) + асети (окрема сторінка).

Далі — тільки **Organisation scan**.

---

## 1) Organisation scan — ціль сторінки

Користувач за **1–2 хвилини**:

- обирає організацію (або “усі”),
- перевіряє/коригує список асетів (вибір, пошук, додати вручну, імпорт з файла),
- синкає асети з NetBox,
- обирає пресет і (за потреби) вимикає деякі модулі,
- отримує/редагує команду запуску **bbot** + бачить **help** по аргументах.

---

## 2) UI (компоненти сторінки)

### 2.1. Блок “Organisation”

**Компоненти:**
- **Dropdown Organisation** з пошуком:
  - опції: *конкретна організація*, **All organisations**
- Кнопка **Sync assets** (NetBox)
- Статуси:
  - `Last sync: …`
  - `Sync in progress… / Success / Failed`

**Правила:**
- Обрав організацію → підтягуємо асети, прив’язані до неї.
- Обрав **All organisations** → підтягуємо всі асети з бази (або агреговано по всіх org).

---

### 2.2. Блок “Assets for scan”

**Компоненти:**
- Таблиця/список асетів з чекбоксами:
  - колонки мінімум: `selected`, `type`, `value`, `source (NetBox/Manual/File)`, `organisation` (якщо All)
- Пошук по асетах (рядок пошуку + фільтр по типу):
  - типи: `ip`, `cidr`, `domain`, `url` (мінімум `ip/cidr/domain`)
- Додавання вручну:
  - поле вводу (multi-line або “chip input”)
  - кнопка **Add assets**
- Імпорт з файла:
  - Upload `.txt` / `.csv`
  - кнопка **Import**
  - показ: `Imported N новых, M дублів пропущено`

**Правила:**
- За замовчуванням всі підтягнуті асети = **увімкнені**.
- Користувач може вимкнути/увімкнути кожен асет чекбоксом.
- Ручний ввід та імпорт додають асети в цей список і автоматично вмикають їх.
- Дублі (однакове `type+value`) не дублюються — або підсвічуються як вже наявні.

**Валідація (MVP мінімум):**
- IP: `x.x.x.x`
- CIDR: `x.x.x.x/nn`
- Domain: `example.com`
- Невалідні рядки → `Skipped N invalid lines` + список помилкових рядків (до 20 шт).

---

### 2.3. Блок “Preset” (остаточно)

**Поведінка / правила:**
- Користувач обирає пресет → бачить:
  - модулі пресету (чекбокси)
  - конфігурацію пресету (preview, read-only)
- Користувач може вимкнути/увімкнути модулі.
- Ці зміни зберігаються для цього конкретного скана (тобто як **“scan-level override”**):
  - при переходах по сторінці/кроках цього скана — не губляться
  - не змінюють сам пресет глобально
- Дефолт: всі модулі **увімкнені**.

---

### 2.4. “BBOT command + Help”

**Поведінка / правила:**
- Команда автогенерується на базі: `assets + preset + enabled modules`.
- Поле команди **editable** (користувач редагує прямо в команді).
- Як тільки користувач вручну змінив команду, система переходить у режим **Manual**:
  - далі не перегенеровує команду автоматично, навіть якщо користувач змінює асети/пресет/модулі
- Є кнопка **Regenerate**:
  - повертає команду до автозгенерованого стану за поточними вибраними параметрами
  - після натискання **Regenerate** режим **Manual** скидається (знову **auto**).

---

### 2.5. Блок “Scan name”

**Компоненти:**
- Поле **Scan name** (text input)
  - placeholder: `Напр. "OrgName-passive-2025-12-25"`
  - дозволяє будь-який текст (вільний ввід)

**Поведінка / правила:**
- Користувач може ввести назву скану вручну.
- Якщо поле порожнє — система підставляє дефолтну назву (автогенерація), але користувач може її переписати.
- Назва скану:
  - зберігається для цього скана
  - відображається в кінці флоу/перед запуском (як фінальний підсумок)

---

## 3) Основний користувацький флоу (MVP)

1. Користувач відкриває **Organisation scan** → бачить останній sync-статус.
2. Обирає організацію (або **All**) → список асетів підтягується та відмічений чекбоксами.
3. За потреби:
   - вимикає зайві асети,
   - додає вручну,
   - імпортує файл,
   - натискає **Sync assets** (оновлює дані з NetBox).
4. Обирає пресет → бачить модулі → вимикає деякі.
5. Бачить команду → додає extra args → дивиться help → **Validate command**.
